From 1800580e64eb058b5497ec2ab75e07431ad4132b Mon Sep 17 00:00:00 2001
From: Luis Ramirez <luis.ramirez@northern.tech>
Date: Wed, 9 Jul 2025 23:58:30 +0000
Subject: [PATCH] configs toradex board specific mender integration

Signed-off-by: Luis Ramirez <luis.ramirez@northern.tech>
---
 configs/colibri-imx8x_defconfig | 8 +++++---
 include/configs/colibri-imx8x.h | 2 ++
 2 files changed, 7 insertions(+), 3 deletions(-)

diff --git a/configs/colibri-imx8x_defconfig b/configs/colibri-imx8x_defconfig
index 97c28a32a6d..e6bcb50443e 100644
--- a/configs/colibri-imx8x_defconfig
+++ b/configs/colibri-imx8x_defconfig
@@ -6,8 +6,10 @@ CONFIG_SYS_MALLOC_F_LEN=0x8000
 CONFIG_NR_DRAM_BANKS=3
 CONFIG_HAS_CUSTOM_SYS_INIT_SP_ADDR=y
 CONFIG_CUSTOM_SYS_INIT_SP_ADDR=0x80200000
-CONFIG_ENV_SIZE=0x2000
-CONFIG_ENV_OFFSET=0xFFFFDE00
+CONFIG_ENV_SIZE=0x4000
+CONFIG_ENV_OFFSET=0x800000
+CONFIG_ENV_OFFSET_REDUND=0x1000000
+CONFIG_SYS_REDUNDAND_ENVIRONMENT=y
 CONFIG_DM_GPIO=y
 CONFIG_DEFAULT_DEVICE_TREE="fsl-imx8qxp-colibri"
 CONFIG_BOOTAUX_RESERVED_MEM_BASE=0x88000000
@@ -51,7 +53,7 @@ CONFIG_CMD_EXT4_WRITE=y
 CONFIG_ENV_OVERWRITE=y
 CONFIG_ENV_IS_IN_MMC=y
 CONFIG_SYS_RELOC_GD_ENV_ADDR=y
-CONFIG_SYS_MMC_ENV_PART=1
+CONFIG_SYS_MMC_ENV_PART=0
 CONFIG_VERSION_VARIABLE=y
 CONFIG_NET_RANDOM_ETHADDR=y
 CONFIG_IP_DEFRAG=y
diff --git a/include/configs/colibri-imx8x.h b/include/configs/colibri-imx8x.h
index 8f2d49be3b1..f57fd18a1f4 100644
--- a/include/configs/colibri-imx8x.h
+++ b/include/configs/colibri-imx8x.h
@@ -49,6 +49,8 @@
 		"${blkcnt} / 0x200; mmc dev 0 1; mmc write ${loadaddr} 0x0 " \
 		"${blkcnt}; fi\0"
 
+#define CONFIG_BOOTCOUNT_ENV
+#define CONFIG_BOOTCOUNT_LIMIT		
 #define CFG_SYS_SDRAM_BASE		0x80000000
 #define PHYS_SDRAM_1			0x80000000
 #define PHYS_SDRAM_2			0x880000000
-- 
2.44.3

